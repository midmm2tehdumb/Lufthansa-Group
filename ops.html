<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Operations | Lufthansa GeoFS</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>

    <nav class="main-nav" id="navbar">
        <div class="nav-wrapper">
            <div class="nav-left">
                <a href="index.html" class="logo-link">
                    <img src="logo.png" alt="Logo" class="nav-logo">
                    <span>Lufthansa GeoFS</span>
                </a>
            </div>
            <ul class="nav-links">
                <li class="pillar-link" onclick="toggleMenu('ops-menu')">Flight Operations</li>
                <li class="pillar-link" onclick="toggleMenu('network-menu')">Live Network</li>
                <li class="pillar-link" onclick="toggleMenu('media-news')">Media & News</li>
                <li class="pillar-link" onclick="toggleMenu('crew-menu')">Crew & Community</li>
            </ul>
            <div class="hamburger" onclick="toggleMobileMenu()">
                <div class="bar"></div><div class="bar"></div><div class="bar"></div>
            </div>
        </div>
        <div class="mega-overlay" id="menu-overlay" onclick="closeAllMenus()"></div>
        <div id="ops-menu" class="mega-panel">
            <div class="panel-content">
                <div class="menu-col"><h3>Ops Center</h3><a href="ops.html">Flight Dispatch</a><a href="livery-db.html">Livery Database</a></div>
                <div class="menu-col"><h3>Fleet</h3><a href="fleet.html">Main Fleet</a><a href="sop-manuals.html">SOP & Manuals</a></div>
            </div>
        </div>
        <div id="network-menu" class="mega-panel">
            <div class="panel-content">
                <div class="menu-col"><h3>Network Hub</h3><a href="network.html">Route Map</a><a href="radar.html">Live Radar</a></div>
                <div class="menu-col"><h3>Hubs</h3><a href="hub-info.html#fra">Frankfurt (FRA)</a><a href="hub-info.html#muc">Munich (MUC)</a></div>
            </div>
        </div>
        <div id="media-news" class="mega-panel">
            <div class="panel-content">
                <div class="menu-col"><h3>The Gazette</h3><a href="news.html">Latest News</a><a href="gallery.html">Fleet Gallery</a></div>
            </div>
        </div>
        <div id="crew-menu" class="mega-panel">
            <div class="panel-content">
                <div class="menu-col"><h3>The Elite</h3><a href="hall-of-fame.html">Hall of Fame</a><a href="service-medals.html">Service Medals</a></div>
                <div class="menu-col"><h3>Highlights</h3><a href="highlights.html">Our Perks</a></div>
            </div>
        </div>
    </nav>

    <main class="ops-main">
        <header class="page-title">
            <h1>Flight Operations</h1>
            <div class="title-underline"></div>
            <p>Ready for departure? Access your tools and hub conditions below.</p>
        </header>


        <section class="dispatch-tool">
    <div class="tool-container">
        <div class="tool-inputs">
            <div class="field">
                <label>Departure</label>
                <select id="departure" class="ops-select"></select>
            </div>
            <div class="field">
                <label>Arrival</label>
                <select id="arrival" class="ops-select"></select>
            </div>
            <button onclick="calculateFlight()" class="btn-calculate">Generate Flight Plan</button>
        </div>

        <div id="dispatch-results" class="dispatch-results-grid" style="display: none;">
            </div>
    </div>
</section>
        
        <div class="ops-grid">
            
            <div class="ops-card">
                <div class="card-content">
                    <h3>Frankfurt (EDDF)</h3>
                    <iframe src="https://checkwx.com/weather/EDDF/metar" width="100%" height="200" frameborder="0" style="border-radius: 8px;"></iframe>
                </div>
                <a href="https://checkwx.com/weather/EDDF/metar" target="_blank" class="btn-outline-blue">Full Weather Report</a>
            </div>

            <div class="ops-card">
                <div class="card-content">
                    <h3>Munich (EDDM)</h3>
                    <iframe src="https://checkwx.com/weather/EDDM/metar" width="100%" height="200" frameborder="0" style="border-radius: 8px;"></iframe>
                </div>
                <a href="https://checkwx.com/weather/EDDM/metar" target="_blank" class="btn-outline-blue">Full Weather Report</a>
            </div>

            <div class="ops-card">
                <div class="card-content">
                    <h3>Route Network</h3>
                    <p>View our global destinations, subsidiary hubs, and searchable airport directory.</p>
                </div>
                <a href="network.html" class="btn-outline-blue">Open Route Map</a>
            </div>

            <div class="ops-card">
                <div class="card-content">
                    <h3>Live Fleet Radar</h3>
                    <p>Real-time tracking of active Lufthansa callsigns across the GeoFS world.</p>
                </div>
                <a href="radar.html" class="btn-outline-blue">Open Live Radar</a>
            </div>

            <div class="ops-card">
                <div class="card-content">
                    <h3>Flight Planning</h3>
                    <p>Generate your Operational Flight Plan using SimBrief. Ensure you <strong>follow flight restrictions</strong> and <strong>routes</strong> for realism.</p>
                </div>
                <a href="https://www.simbrief.com/system/dispatch.php" target="_blank" class="btn-gold">Launch SimBrief</a>
            </div>

            <div class="ops-card">
                <div class="card-content">
                    <h3>Livery Database</h3>
                    <p>Access the custom livery files that our team has meticulously created for specific aircraft.</p>
                </div>
                <a href="livery-db.html" class="btn-outline-blue">View Liveries</a>
            </div>

            <div class="ops-card">
                <div class="card-content">
                    <h3>SOP & Manuals</h3>
                    <p>Detailed Standard Operating Procedures for taxi, takeoff, and GeoFS-specific navigation.</p>
                </div>
                <a href="sop-manuals.html" class="btn-outline-blue">Open Manuals</a>
            </div>

            <div class="ops-card">
                <div class="card-content">
                    <h3>Pilot Support</h3>
                    <p>Have questions regarding routes or operations? Connect with the team in the General channel.</p>
                </div>
                <a href="https://discord.com/channels/1404322265214095470/1404322265822396418" target="_blank" class="btn-outline-blue">Discord Help</a>
            </div>

        </div>
    </main>

<script>
    // --- 1. AIRPORT DATA (Names & ICAO) ---
    const airportData = {
        "FRA": {icao: "EDDF", city: "Frankfurt - Lufthansa Primary"},
        "MUC": {icao: "EDDM", city: "Munich - Lufthansa Secondary"},
        "ABV": {icao: "DNAA", city: "Abuja"},
        "AUH": {icao: "OMAA", city: "Abu Dhabi"},
        "ALC": {icao: "LEAL", city: "Alicante"},
        "ALG": {icao: "DAAG", city: "Algiers"},
        "ALA": {icao: "UAAA", city: "Almaty"},
        "AMM": {icao: "OJAI", city: "Amman"}, 
        "AMS": {icao: "EHAM", city: "Amsterdam - KLM Hub"},
        "AOI": {icao: "LIPY", city: "Ancona"},
        "ATH": {icao: "LGAV", city: "Athens"},
        "ATL": {icao: "KATL", city: "Atlanta"},
        "OVD": {icao: "LEAS", city: "Asturias"},
        "GYD": {icao: "UBBB", city: "Baku"},
        "BKK": {icao: "VTBS", city: "Bangkok"},
        "BLR": {icao: "VOBL", city: "Bangalore"},
        "BCN": {icao: "LEBL", city: "Barcelona"},
        "BRI": {icao: "LIBD", city: "Bari"},
        "BSL": {icao: "LFSB", city: "Basel"},
        "BIA": {icao: "LFKB", city: "Bastia"},
        "PEK": {icao: "ZBAA", city: "Beijing"},
        "BEY": {icao: "OLBA", city: "Beirut"}, 
        "BEG": {icao: "LYBE", city: "Belgrade"},
        "BGO": {icao: "ENBR", city: "Bergen"},
        "BER": {icao: "EDDB", city: "Berlin"},
        "BIQ": {icao: "LFBZ", city: "Biarritz"},
        "BIO": {icao: "LEBB", city: "Bilbao"},
        "BLL": {icao: "EKBI", city: "Billund"},
        "BHX": {icao: "EGBB", city: "Birmingham"},
        "BOG": {icao: "SKBO", city: "Bogota"},
        "BLQ": {icao: "LIPE", city: "Bologna"},
        "BOD": {icao: "LFBD", city: "Bordeaux"},
        "BOS": {icao: "KBOS", city: "Boston"},
        "BRE": {icao: "EDDW", city: "Bremen"},
        "BDS": {icao: "LIBR", city: "Brindisi"},
        "BRU": {icao: "EBBR", city: "Brussels - Brussels Airlines hub"},
        "OTP": {icao: "LROP", city: "Bucharest"},
        "BUD": {icao: "LHBP", city: "Budapest"},
        "EZE": {icao: "SAEZ", city: "Buenos Aires"},
        "BOJ": {icao: "LBBG", city: "Burgas"},
        "CAG": {icao: "LIEE", city: "Cagliari"},
        "CAI": {icao: "HECA", city: "Cairo"},
        "YYC": {icao: "CYYC", city: "Calgary"},
        "CPT": {icao: "FACT", city: "Cape Town"},
        "CTA": {icao: "LICC", city: "Catania"},
        "CLT": {icao: "KCLT", city: "Charlotte"},
        "MAA": {icao: "VOMM", city: "Chennai"},
        "ORD": {icao: "KORD", city: "Chicago"},
        "CLJ": {icao: "LRCL", city: "Cluj"},
        "CGN": {icao: "EDDK", city: "Cologne"},
        "CPH": {icao: "EKCH", city: "Copenhagen"},
        "ORK": {icao: "EICK", city: "Cork"},
        "CFU": {icao: "LGKR", city: "Corfu"},
        "DFW": {icao: "KDFW", city: "Dallas"},
        "DMM": {icao: "OEDF", city: "Dammam"},
        "DEB": {icao: "LHDC", city: "Debrecen"},
        "DEL": {icao: "VIDP", city: "Delhi"},
        "DEN": {icao: "KDEN", city: "Denver"},
        "DTW": {icao: "KDTW", city: "Detroit"},
        "DRS": {icao: "EDDC", city: "Dresden"},
        "DUB": {icao: "EIDW", city: "Dublin"},
        "DXB": {icao: "OMDB", city: "Dubai"},
        "DBV": {icao: "LDDU", city: "Dubrovnik"},
        "DME": {icao: "UUDD", city: "Moscow"},
        "DUS": {icao: "EDDL", city: "Dusseldorf"},
        "EDI": {icao: "EGPH", city: "Edinburgh"},
        "ERF": {icao: "EDDE", city: "Erfurt"},
        "EBL": {icao: "ORER", city: "Erbil"},
        "FAO": {icao: "LPFR", city: "Faro"},
        "FLR": {icao: "LIRQ", city: "Florence"},
        "GDN": {icao: "EPGD", city: "Gdansk"},
        "GVA": {icao: "LSGG", city: "Geneva - Swiss Hub"},
        "GLA": {icao: "EGPF", city: "Glasgow"},
        "GOT": {icao: "ESGG", city: "Gothenburg"},
        "GRZ": {icao: "LOWG", city: "Graz"},
        "HAM": {icao: "EDDH", city: "Hamburg"},
        "HAJ": {icao: "EDDV", city: "Hanover"},
        "HEL": {icao: "EFHK", city: "Helsinki"},
        "HER": {icao: "LGIR", city: "Heraklion"},
        "HDF": {icao: "EDAH", city: "Heringsdorf"},
        "HKG": {icao: "VHHH", city: "Hong Kong"},
        "IAH": {icao: "KIAH", city: "Houston"},
        "HYD": {icao: "VOHY", city: "Hyderabad"},
        "IVL": {icao: "EFIV", city: "Ivalo"},
        "IBZ": {icao: "LEIB", city: "Ibiza"},
        "IST": {icao: "LTBA", city: "Istanbul"},
        "ADB": {icao: "LTBJ", city: "Izmir"},
        "JED": {icao: "OEJN", city: "Jeddah"},
        "JNB": {icao: "FAOR", city: "Johannesburg"},
        "KLX": {icao: "LGKL", city: "Kalamata"},
        "KBP": {icao: "UKBB", city: "Kiev"},
        "FKB": {icao: "EDSB", city: "Karlsruhe"},
        "KTW": {icao: "EPKT", city: "Katowice"},
        "EFL": {icao: "LGKF", city: "Kefalonia"},
        "KTT": {icao: "EFKT", city: "KittilÃ¤"},
        "KGS": {icao: "LGKO", city: "Kos"},
        "KRK": {icao: "EPKK", city: "Krakow"},
        "KAO": {icao: "EFRO", city: "Kuusamo"},
        "KWI": {icao: "OKKK", city: "Kuwait City"},
        "LOS": {icao: "DNMM", city: "Lagos"},
        "SUF": {icao: "LICA", city: "Lamezia"},
        "LCA": {icao: "LCLK", city: "Larnaca"},
        "LEJ": {icao: "EDDP", city: "Leipzig"},
        "LIS": {icao: "LPPT", city: "Lisbon"},
        "LNZ": {icao: "LOWL", city: "Linz"},
        "LHR": {icao: "EGLL", city: "London"},
        "STN": {icao: "EGSS", city: "London"},
        "LAX": {icao: "KLAX", city: "Los Angeles"},
        "LAD": {icao: "FNLU", city: "Luanda"},
        "LUX": {icao: "ELLX", city: "Luxembourg"},
        "LYS": {icao: "LFLL", city: "Lyon"},
        "MAD": {icao: "LEMD", city: "Madrid"},
        "SSG": {icao: "FQMA", city: "Malabo"},
        "AGP": {icao: "LEMG", city: "Malaga"},
        "MLA": {icao: "LMML", city: "Malta"},
        "MAN": {icao: "EGCC", city: "Manchester"},
        "MRS": {icao: "LFML", city: "Marseille"},
        "MEX": {icao: "MMMX", city: "Mexico City"},
        "MIA": {icao: "KMIA", city: "Miami"},
        "LIN": {icao: "LIML", city: "Milan"},
        "MXP": {icao: "LIMC", city: "Milan"},
        "MSP": {icao: "KMSP", city: "Minneapolis"},
        "YUL": {icao: "CYUL", city: "Montreal"},
        "BOM": {icao: "VABB", city: "Mumbai"},
        "FMO": {icao: "EDDG", city: "Munster"},
        "JMK": {icao: "LGMK", city: "Mykonos"},
        "NBO": {icao: "HKJK", city: "Nairobi"},
        "NTE": {icao: "LFRS", city: "Nantes"},
        "NAP": {icao: "LIRN", city: "Naples"},
        "NCL": {icao: "EGNT", city: "Newcastle"},
        "JFK": {icao: "KJFK", city: "New York"},
        "EWR": {icao: "KEWR", city: "Newark"},
        "NCE": {icao: "LFMN", city: "Nice"},
        "NUE": {icao: "EDDN", city: "Nuremberg"},
        "OLB": {icao: "LIEO", city: "Olbia"},
        "KIX": {icao: "34.4347, 135.2441", city: "Osaka"},
        "OSL": {icao: "ENGM", city: "Oslo"},
        "PMO": {icao: "LICJ", city: "Palermo"},
        "PMI": {icao: "LEPA", city: "Palma de Mallorca"},
        "PTY": {icao: "MPTO", city: "Panama City"},
        "PFO": {icao: "LCPH", city: "Paphos"},
        "CDG": {icao: "LFPG", city: "Paris"},
        "PHL": {icao: "KPHL", city: "Philadelphia"},
        "PHC": {icao: "DNPO", city: "Port Harcourt"},
        "OPO": {icao: "LPPR", city: "Porto"},
        "POZ": {icao: "EPPO", city: "Poznan"},
        "PRG": {icao: "LKPR", city: "Prague"},
        "PUY": {icao: "LDPL", city: "Pula"},
        "RDU": {icao: "KRDU", city: "Raleigh"},
        "KEF": {icao: "BIKF", city: "Reykjavik"},
        "RHO": {icao: "LGRP", city: "Rhodes"},
        "RIX": {icao: "EVRA", city: "Riga"},
        "RJK": {icao: "LDRI", city: "Rijeka"},
        "GIG": {icao: "SBGL", city: "Rio de Janeiro"},
        "RUH": {icao: "OERK", city: "Riyadh"},
        "FCO": {icao: "LIRF", city: "Rome"},
        "RVN": {icao: "EFRO", city: "Rovaniemi"},
        "SZG": {icao: "LOWS", city: "Salzburg"},
        "SFO": {icao: "KSFO", city: "San Francisco"},
        "SJO": {icao: "MROC", city: "San Jose (CR)"},
        "SJC": {icao: "KSJC", city: "San Jose (US)"},
        "JTR": {icao: "LGSR", city: "Santorini"},
        "SCQ": {icao: "LEST", city: "Santiago de Compostela"},
        "SJJ": {icao: "LQSA", city: "Sarajevo"},
        "GRU": {icao: "SBGR", city: "Sao Paulo"},
        "SEA": {icao: "KSEA", city: "Seattle"},
        "ICN": {icao: "RKSI", city: "Seoul"},
        "SVQ": {icao: "LEZL", city: "Seville"},
        "PVG": {icao: "ZSPD", city: "Shanghai"},
        "SIN": {icao: "WSSS", city: "Singapore"},
        "SOF": {icao: "LBSF", city: "Sofia"},
        "SPU": {icao: "LDSP", city: "Split"},
        "SVG": {icao: "ENZV", city: "Stavanger"},
        "STL": {icao: "KSTL", city: "St. Louis"},
        "ARN": {icao: "ESSA", city: "Stockholm"},
        "SXB": {icao: "LFST", city: "Strasbourg"},
        "STR": {icao: "EDDS", city: "Stuttgart"},
        "TLL": {icao: "EETN", city: "Tallinn"},
        "IKA": {icao: "OIIE", city: "Tehran"},
        "TLV": {icao: "LLBG", city: "Tel Aviv"}, 
        "SKG": {icao: "LGTS", city: "Thessaloniki"},
        "TIA": {icao: "LATI", city: "Tirana"},
        "TIV": {icao: "LYTV", city: "Tivat"},
        "HND": {icao: "RJTT", city: "Tokyo"},
        "YYZ": {icao: "CYYZ", city: "Toronto"},
        "TOS": {icao: "ENTC", city: "TromsÃ¸"},
        "TRD": {icao: "ENVA", city: "Trondheim"},
        "TUN": {icao: "DTTA", city: "Tunis"},
        "VLC": {icao: "LEVC", city: "Valencia"},
        "YVR": {icao: "CYVR", city: "Vancouver"},
        "VAR": {icao: "LBWN", city: "Varna"},
        "VCE": {icao: "LIPZ", city: "Venice"},
        "VIE": {icao: "LOWW", city: "Vienna - Austrian Hub"},
        "VNO": {icao: "EYVI", city: "Vilnius"},
        "WAW": {icao: "EPWA", city: "Warsaw"},
        "IAD": {icao: "KIAD", city: "Washington"},
        "GWT": {icao: "EDXW", city: "Westerland"},
        "WRO": {icao: "EPWR", city: "Wroclaw"},
        "WBG": {icao: "EDFW", city: "Wurzburg"},
        "ZAD": {icao: "LDZD", city: "Zadar"},
        "ZAG": {icao: "LDZA", city: "Zagreb"},
        "ZTH": {icao: "LGZA", city: "Zakynthos"},
        "ZRH": {icao: "LSZH", city: "Zurich - Swiss Hub"},
        "PER": {icao: "YPPH", city: "Perth - Longest DLH Flight (17HR)"}
    };

    // --- 2. AIRPORT COORDINATES (Lat, Lon, UTC Offset) ---
    const airportCoords = {
        "FRA": [50.0379, 8.5622, 1], "MUC": [48.3538, 11.7861, 1], "ABV": [9.0060, 7.2636, 1], "AUH": [24.4321, 54.6516, 4],
        "ALC": [38.2822, -0.5581, 1], "ALG": [36.6911, 3.2158, 1], "ALA": [43.3521, 77.0403, 6], "AMM": [31.7226, 35.9935, 2],
        "AMS": [52.3086, 4.7639, 1], "AOI": [43.6169, 13.5189, 1], "ATH": [37.9364, 23.9445, 2], "ATL": [33.6407, -84.4279, -5],
        "OVD": [43.5631, -6.0346, 1], "GYD": [40.4675, 50.0469, 4], "BKK": [13.6811, 100.7472, 7], "BLR": [13.1979, 77.7063, 5.5],
        "BCN": [41.2974, 2.0833, 1], "BRI": [41.1388, 16.7600, 1], "BSL": [47.5931, 7.5297, 1], "BIA": [42.5522, 9.4831, 1],
        "PEK": [40.0801, 116.5846, 8], "BEY": [33.8886, 35.4955, 2], "BEG": [44.8186, 20.3092, 1], "BGO": [60.2931, 5.2189, 1],
        "BER": [52.3667, 13.5033, 1], "BIQ": [43.4681, -1.5316, 1], "BIO": [43.3013, -2.9100, 1], "BLL": [55.7401, 9.1517, 1],
        "BHX": [52.4530, -1.7480, 0], "BOG": [4.7016, -74.1469, -5], "BLQ": [44.5356, 11.2889, 1], "BOD": [44.8281, -0.7156, 1],
        "BOS": [42.3656, -71.0096, -5], "BRE": [53.0475, 8.7861, 1], "BDS": [40.6578, 17.9478, 1], "BRU": [50.9014, 4.4844, 1],
        "OTP": [44.5722, 26.1025, 2], "BUD": [47.4369, 19.2556, 1], "EZE": [-34.8222, -58.5358, -3], "BOJ": [42.5694, 27.5150, 2],
        "CAG": [39.2511, 9.0544, 1], "CAI": [30.1160, 31.4172, 2], "YYC": [51.1139, -114.0196, -7], "CPT": [-33.9700, 18.6021, 2],
        "CTA": [37.4661, 15.0650, 1], "CLT": [35.2140, -80.9431, -5], "MAA": [12.9949, 80.1690, 5.5], "ORD": [41.9742, -87.9073, -6],
        "CLJ": [46.7857, 23.6861, 2], "CGN": [50.8659, 7.1427, 1], "CPH": [55.6181, 12.6558, 1], "ORK": [51.8372, -8.4917, 0],
        "CFU": [39.6019, 19.9117, 2], "DFW": [32.8998, -97.0403, -6], "DMM": [26.4714, 50.1033, 3], "DEB": [47.3031, 21.6486, 1],
        "DEL": [28.5562, 77.1000, 5.5], "DEN": [39.8561, -104.6737, -7], "DTW": [42.2124, -83.3534, -5], "DRS": [51.1322, 13.7672, 1],
        "DUB": [53.4273, -6.2436, 0], "DXB": [25.2532, 55.3657, 4], "DBV": [42.5610, 18.2680, 1], "DUS": [51.2895, 6.7668, 1],
        "EDI": [55.9500, -3.3725, 0], "ERF": [51.8419, 11.0044, 1], "EBL": [36.2390, 43.9630, 3], "FAO": [37.0146, -7.9659, 0],
        "FLR": [43.8106, 11.2050, 1], "GDN": [54.3771, 18.4661, 1], "GVA": [46.2381, 6.1083, 1], "GLA": [55.8719, -4.4331, 0],
        "GOT": [57.6681, 11.7869, 1], "GRZ": [46.9914, 15.4390, 1], "HAM": [53.6300, 9.9880, 1], "HAJ": [52.4611, 9.6850, 1],
        "HEL": [60.3172, 24.9633, 2], "HER": [35.3397, 25.1808, 2], "HDF": [54.5803, 13.4089, 1], "HKG": [22.3080, 113.9185, 8],
        "IAH": [29.9844, -95.3414, -6], "HYD": [17.2313, 78.4294, 5.5], "IVL": [68.6071, 27.4058, 2], "IBZ": [38.8724, 1.3739, 1],
        "IST": [40.9769, 28.8146, 3], "ADB": [38.3206, 27.1561, 3], "JED": [21.6796, 39.1566, 3], "JNB": [-26.1392, 28.2460, 2],
        "KLX": [36.8617, 22.4992, 2], "FKB": [48.7800, 8.0800, 1], "KTW": [50.4744, 19.0800, 1], "EFL": [38.1206, 20.5000, 2],
        "KTT": [67.7003, 24.8500, 2], "KGS": [36.8917, 27.2883, 2], "KRK": [50.0777, 19.7846, 1], "KAO": [65.9800, 29.2300, 3],
        "KWI": [29.2266, 47.9689, 3], "LOS": [6.5773, 3.3212, 1], "SUF": [38.9006, 16.2425, 1], "LCA": [34.8756, 33.6244, 2],
        "LEJ": [51.4231, 12.2367, 1], "LIS": [38.7712, -9.1342, 0], "LNZ": [48.2339, 14.1878, 1], "LHR": [51.4700, -0.4543, 0],
        "STN": [51.8890, 0.2330, 0], "LAX": [33.9425, -118.4081, -8], "LAD": [-8.8368, 13.2317, 1], "LUX": [49.6266, 6.2110, 1],
        "LYS": [45.7256, 5.0811, 1], "MAD": [40.4719, -3.5626, 1], "SSG": [3.7500, 8.7833, 1], "AGP": [36.6749, -4.4991, 1],
        "MLA": [35.8575, 14.4775, 1], "MAN": [53.3650, -2.2725, 0], "MRS": [43.4372, 5.2140, 1], "MEX": [19.4361, -99.0719, -6],
        "MIA": [25.7959, -80.2871, -5], "LIN": [45.4450, 9.2769, 1], "MXP": [45.6306, 8.7231, 1], "MSP": [44.8848, -93.2223, -6],
        "YUL": [45.4576, -73.7492, -5], "BOM": [19.0896, 72.8656, 5.5], "FMO": [52.1347, 7.6856, 1], "JMK": [36.3969, 25.4294, 2],
        "NBO": [-1.3192, 36.9275, 3], "NTE": [47.1539, -1.6111, 1], "NAP": [40.8860, 14.2906, 1], "NCL": [55.0375, -1.6917, 0],
        "JFK": [40.6413, -73.7781, -5], "EWR": [40.6895, -74.1745, -5], "NCE": [43.6584, 7.2159, 1], "NUE": [49.4987, 11.0784, 1],
        "OLB": [40.9022, 9.5172, 1], "KIX": [34.4347, 135.2441, 9], "OSL": [60.1939, 11.1004, 1], "PMO": [38.1758, 13.0914, 1],
        "PMI": [39.5519, 2.7386, 1], "PTY": [8.9533, -79.5558, -5], "PFO": [34.7150, 32.4850, 2], "CDG": [49.0097, 2.5479, 1],
        "PHL": [39.8719, -75.2411, -5], "PHC": [4.9350, 7.0131, 1], "OPO": [41.2481, -8.6819, 0], "POZ": [52.4214, 16.8261, 1],
        "PRG": [50.1008, 14.2710, 1], "PUY": [44.8936, 13.9189, 1], "RDU": [35.8776, -78.7875, -5], "KEF": [63.9850, -22.6056, 0],
        "RHO": [36.4347, 28.2178, 2], "RIX": [56.9225, 24.0831, 2], "RJK": [45.2167, 14.5708, 1], "GIG": [-22.8090, -43.2506, -3],
        "RUH": [24.9570, 46.6985, 3], "FCO": [41.7999, 12.2462, 1], "RVN": [66.3625, 25.8300, 2], "SZG": [47.7939, 13.0042, 1],
        "SFO": [37.6189, -122.3750, -8], "SJO": [9.9939, -84.2086, -6], "SJC": [37.3626, -121.9290, -8], "JTR": [36.3991, 25.4794, 2],
        "SCQ": [42.8961, -8.4150, 1], "SJJ": [43.8247, 18.3311, 1], "GRU": [-23.4356, -46.4731, -3], "SEA": [47.4489, -122.3090, -8],
        "ICN": [37.4602, 126.4407, 9], "SVQ": [37.4192, -5.9003, 1], "PVG": [31.1443, 121.8083, 8], "SIN": [1.3592, 103.9894, 8],
        "SOF": [42.6950, 23.4060, 2], "SPU": [43.5386, 16.2986, 1], "SVG": [58.8761, 5.6375, 1], "STL": [38.7487, -90.3700, -6],
        "ARN": [59.6519, 17.9186, 1], "SXB": [48.5383, 7.6283, 1], "STR": [48.6897, 9.2219, 1], "TLL": [59.4133, 24.8322, 2],
        "IKA": [35.4161, 51.1522, 3.5], "TLV": [32.0114, 34.8866, 2], "SKG": [40.5181, 22.9747, 2], "TIA": [41.4142, 19.7204, 1],
        "TIV": [42.4042, 18.7233, 1], "HND": [35.5494, 139.7798, 9], "YYZ": [43.6777, -79.6248, -5], "TOS": [69.6828, 18.9181, 1],
        "TRD": [63.4571, 10.9241, 1], "TUN": [36.8510, 10.2273, 1], "VLC": [39.4897, -0.4819, 1], "YVR": [49.1936, -123.1836, -8],
        "VAR": [43.2076, 27.8251, 2], "VCE": [45.5052, 12.3519, 1], "VIE": [48.1103, 16.5697, 1], "VNO": [54.6740, 25.2854, 2],
        "WAW": [52.1657, 20.9671, 1], "IAD": [38.9444, -77.4558, -5], "GWT": [54.9136, 8.3475, 1], "WRO": [51.1020, 17.0304, 1],
        "WBG": [49.8106, 9.9425, 1], "ZAD": [44.1086, 15.3467, 1], "ZAG": [45.7420, 16.0680, 1], "ZTH": [37.7500, 20.8842, 2],
        "ZRH": [47.4581, 8.5492, 1], 
        "PER": [-31.9385, 115.9672, 8]
    };

    // --- 3. CORE LOGIC & DROPDOWNS ---
    function populateAirports() {
        const depSelect = document.getElementById('departure');
        const arrSelect = document.getElementById('arrival');
        
        depSelect.innerHTML = '<option value="">-- Select Departure --</option>';
        arrSelect.innerHTML = '<option value="">-- Select Arrival --</option>';

        Object.keys(airportData).sort().forEach(iata => {
            const entry = airportData[iata];
            const text = `${iata} - ${entry.city} (${entry.icao})`;
            
            depSelect.add(new Option(text, iata));
            arrSelect.add(new Option(text, iata));
        });
    }

    function getDistance(c1, c2) {
        const R = 6371; 
        const dLat = (c2[0] - c1[0]) * Math.PI / 180;
        const dLon = (c2[1] - c1[1]) * Math.PI / 180;
        const a = Math.sin(dLat / 2) ** 2 + Math.cos(c1[0] * Math.PI / 180) * Math.cos(c2[0] * Math.PI / 180) * Math.sin(dLon / 2) ** 2;
        return R * (2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a)));
    }

    function estimateTime(distance, depIata, arrIata) {
        const depC = airportCoords[depIata];
        const arrC = airportCoords[arrIata];
        let routingFactor = distance > 4500 ? 1.08 : 1.15;
        let windFactor = 1.0;
        const lonDiff = depC[1] - arrC[1]; 
        if (distance > 4000) { windFactor = lonDiff > 0 ? 1.08 : 0.94; }
        const cruiseSpeed = distance > 4500 ? 870 : 820;
        const climbDescentTime = 0.75; 
        return ((distance * routingFactor) / cruiseSpeed + climbDescentTime) * windFactor;
    }

    function suggestPlane(dist) {
        if(dist < 1200) return "A320neo / A321 / CRJ-900";
        if(dist < 5000) return "A321LR / A330-300";
        return "A350-900 / 747-8i / 777-9";
    }

    function formatLocalTimeWithOffset(utcDate, offsetHours) {
        const d = new Date(utcDate.getTime());
        d.setUTCHours(d.getUTCHours() + offsetHours);
        return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', timeZone: 'UTC' });
    }

    function calculateFlight() {
        const dep = document.getElementById('departure').value;
        const arr = document.getElementById('arrival').value;
        const resDiv = document.getElementById('dispatch-results');

        if(!dep || !arr || dep === arr) { alert("Invalid Selection"); return; }

        const dist = getDistance(airportCoords[dep], airportCoords[arr]);
        const flightHours = estimateTime(dist, dep, arr);
        const plane = suggestPlane(dist);

        const nowUTC = new Date();
        const arrivalUTC = new Date(nowUTC.getTime() + (flightHours * 3600000));

        resDiv.style.display = "grid";
        resDiv.innerHTML = `
            <div class="result-card">
                <span class="res-label">Route Information</span>
                <span class="res-data">${airportData[dep].city} (${airportData[dep].icao}) â†’ ${airportData[arr].city} (${airportData[arr].icao})</span>
                <span class="res-sub">Distance: ${dist.toFixed(0)} KM</span>
            </div>
            <div class="result-card">
                <span class="res-label">Fleet Suggestion</span>
                <span class="res-data">${plane}</span>
                <span class="res-sub">ETE: ${Math.floor(flightHours)}h ${Math.round((flightHours % 1) * 60)}m</span>
            </div>
            <div class="result-card">
                <span class="res-label">Your Local Time</span>
                <span class="res-data">ðŸ›« ${nowUTC.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</span>
                <span class="res-data">ðŸ›¬ ${arrivalUTC.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</span>
            </div>
            <div class="result-card">
                <span class="res-label">Hub Local Times</span>
                <span class="res-data">ðŸ›« ${dep}: ${formatLocalTimeWithOffset(nowUTC, airportCoords[dep][2])}</span>
                <span class="res-data">ðŸ›¬ ${arr}: ${formatLocalTimeWithOffset(arrivalUTC, airportCoords[arr][2])}</span>
            </div>
        `;
    }

    // Navbar & Initialization
    window.onload = populateAirports;

    let lastScrollY = window.scrollY;
    const navbar = document.getElementById("navbar");
    window.addEventListener("scroll", () => {
        if (window.scrollY > lastScrollY && window.scrollY > 150) {
            navbar.classList.add("nav-hidden");
            closeAllMenus(); 
        } else { navbar.classList.remove("nav-hidden"); }
        lastScrollY = window.scrollY;
    });

    function toggleMenu(menuId) {
        const menu = document.getElementById(menuId);
        const overlay = document.getElementById("menu-overlay");
        const isOpen = menu.classList.contains("active");
        closeAllMenus();
        if (!isOpen) { menu.classList.add("active"); overlay.classList.add("active"); }
    }

    function closeAllMenus() {
        document.querySelectorAll('.mega-panel').forEach(p => p.classList.remove('active'));
        const overlay = document.getElementById("menu-overlay");
        if(overlay) overlay.classList.remove("active");
    }

    function toggleMobileMenu() {
        const m = document.getElementById("mobile-menu");
        if(!m) return;
        m.classList.toggle("open");
        if(!m.classList.contains("open")) backToMainMobile();
        document.body.style.overflow = m.classList.contains("open") ? "hidden" : "auto";
    }

    function showSubMobile(subId) {
        const main = document.getElementById("mobile-main-links");
        const sub = document.getElementById(subId);
        const back = document.getElementById("mobile-back");
        if(main) main.style.display = "none";
        if(sub) sub.style.display = "block";
        if(back) back.style.display = "inline";
    }

    function backToMainMobile() {
        const main = document.getElementById("mobile-main-links");
        const back = document.getElementById("mobile-back");
        if(main) main.style.display = "block";
        document.querySelectorAll(".mobile-sub-menu").forEach(s => s.style.display = "none");
        if(back) back.style.display = "none";
    }
</script>
</body>
</html>
